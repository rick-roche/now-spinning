name = "now-spinning-api"
main = "src/index.ts"
compatibility_date = "2026-02-12"

# Default = production environment
kv_namespaces = [
  { binding = "NOW_SPINNING_KV", id = "1d0f824e743e4228a407d19deb6f416c", preview_id = "618e3ab2ce1a427ca28f566697420755" }
]

[vars]
PUBLIC_APP_ORIGIN = "https://rickroche.workers.dev"
LASTFM_CALLBACK_URL = "https://rickroche.workers.dev/api/auth/lastfm/callback"
DISCOGS_CALLBACK_URL = "https://rickroche.workers.dev/api/auth/discogs/callback"
DEV_MODE = "false"

[env.development]
kv_namespaces = [
  { binding = "NOW_SPINNING_KV", id = "LOCAL_KV_ID", preview_id = "LOCAL_PREVIEW_KV_ID" }
]

[env.development.vars]
PUBLIC_APP_ORIGIN = "http://localhost:5173"
LASTFM_CALLBACK_URL = "http://localhost:8787/api/auth/lastfm/callback"
DISCOGS_CALLBACK_URL = "http://localhost:8787/api/auth/discogs/callback"
DEV_MODE = "true"

# Secrets (set with: wrangler secret put KEY)
# Note: These are required before OAuth flows will work:
#   - LASTFM_API_KEY
#   - LASTFM_API_SECRET
#   - DISCOGS_CONSUMER_KEY
#   - DISCOGS_CONSUMER_SECRET
